talk_get_setting = {
	if = {
		limit = {
			is_imprisoned = yes		
		}
			
		set_global_variable = {
			name = talk_setting
			value = flag:talk_imprisoned
		}
	}
	else_if = {
		limit = {
			is_in_army = yes	
		}
			
		set_global_variable = {
			name = talk_setting
			value = flag:talk_in_army
		}
	}
	else_if = {
		limit = {
			AND = {
				in_activity_type = activity_feast
				in_activity_with = global_var:talk_first_scope
			}	
		}
			
		set_global_variable = {
			name = talk_setting
			value = flag:talk_in_feast_with_player
		}
	}
	else_if = {
		limit = {
			is_consort_of = global_var:talk_first_scope	
		}
			
		set_global_variable = {
			name = talk_setting
			value = flag:talk_in_bedchamber
		}
	}
}

set_trait_variables = {

	every_character_trait = {
		limit = {
			has_trait_category = personality
		}
		if = {
			limit = {
				NOT = {exists = global_var:talk_trait_1}
			}
			set_global_variable = {
				name = talk_trait_1
				value = this
			}
		}
		else_if = {
			limit = {
				NOT = {exists = global_var:talk_trait_2}
			}
			set_global_variable = {
				name = talk_trait_2
				value = this
			}
		}
		else_if = {
			limit = {
				NOT = {exists = global_var:talk_trait_3}
			}
			set_global_variable = {
				name = talk_trait_3
				value = this
			}
		}
		else_if = {
			limit = {
				NOT = {exists = global_var:talk_trait_4}
			}
			set_global_variable = {
				name = talk_trait_4
				value = this
			}
		}
	
	}
}

remove_trait_variables = {
	remove_global_variable = talk_trait_1
	remove_global_variable = talk_trait_2
	remove_global_variable = talk_trait_3
	remove_global_variable = talk_trait_4
}

set_memory_variables = {
	every_memory = {
		limit = {
				NOT = {exists = global_var:talk_memory_1}
			}
			set_global_variable = {
				name = talk_memory_1
				value = this
			}
	}
}

remove_memory_variables = {
	remove_global_variable = talk_memory_1
}
